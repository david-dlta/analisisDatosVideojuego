---
title: "Analisis datos videojuego"
author: "David de la Torre"
date: "3/9/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Objetivo

El objetivo de este documento es contestar a las preguntas qwue componen cada uno de los ejercicios que figuran a continuación. Con estos ejecicios se pretende demostrar la capacidad de calculo y análisis der metricas comunes en el el ámbito de los videojuegos.

Los datos necesarios para resolver los ejercicios se encuentran en la carpeta _datos_ del proyecto.

## Ejercicio 1: Análisis de datos de sesión

1.  Obtener algunas métricas por país:
  + Media de sesiones, tiempo medio jugado, tiempo jugado por sesión, niveles completados
  + % Pagadores, ARPDAU, ARPU, ARPPU. . .
2. Distribución de alguna métrica que consideres interesante.
3. Comportamiento de la media de sesiones y tiempo medio jugado por sesión del día 0 VS el resto de días.
4. Análisis exploratorio de los datos. Conclusiones.

Lo primero antes de comenzar a resolver las cuestiones es importar los datos facilitados. Para ello utilizaremos el paquete readr. Este paquete nos permite leer archivos en formato _CSV_. El códig a continuación comprueba si el paquete se encuentra instalado, en caso de que no se encuentre lo instala, y posteriormente lo importa.

```{r,message=FALSE}
if(!require(readr)) install.packages(readr)
library(readr)
```

Podemos proceder a importar los datos y almacenarolos en la variable _datos_ej1_.

```{r, message=FALSE}
datos_ej1 = read_delim("datos/task1.1.csv",";")
```

Ahora que ya contamos con los datos en forma de tabla podemos proceder a resolver los ejercicios. Pero antes debemos importar un paquete que nos permita operar, limpiar, ordenar, agrupar, ... los datos. Con el siguiente código instalamos, si fuese necesario necesario, e importamos el paquete.

```{r message=FALSE}
if(!require(dplyr)) install.packages(dplyr)
library(dplyr)
```


### 1.1 Obtener algunas métricas por país

La media de sesiones, tiempo medio jugado, tiempo jugado por sesión, niveles completados lo obtenemos de la siguiente manera:

```{r message=FALSE, warning=FALSE}
mediaSesiones <- datos_ej1 %>%
  select(COUNTRY,ID_SESSION)
 # group_by(COUNTRY) %>%
  #summarise(
  # count(ID_SESSION)
  #) %>%

tiempoMedioJugado <- datos_ej1 %>%
  select(COUNTRY,GAME_TIME) %>%
  group_by(COUNTRY) %>%
  summarise(
    media_GAME_TIME = mean(GAME_TIME)
  )
  
tiempoMedioJugadoSesion <- datos_ej1 %>%
  select(COUNTRY,ID_SESSION,GAME_TIME) %>%
  group_by(COUNTRY, ID_SESSION) %>%
  summarise(
    sum_GAME_TIME = sum(GAME_TIME),
    n = n(),
    medMs = sum_GAME_TIME/n
  ) %>%
  select(COUNTRY,medMs) %>%
  group_by(COUNTRY) %>%
  summarise(
    sum_medMS = sum(medMs),
    n2 = n(),
    mediaMS =sum_medMS/n2
  )

nivelesCompletados <- datos_ej1 %>%
  select(COUNTRY,COMPLETED_LEVELS) %>%
  group_by(COUNTRY) %>%
  summarise(
    media_COMPLETED_LEVELS = mean(COMPLETED_LEVELS)
  )
  
```


Y los resuyltados de las operaciones anteriores serían:

```{r}
mediaSesiones

tiempoMedioJugado

tiempoMedioJugadoSesion

nivelesCompletados
```


### 1.2 Distribución de alguna métrica uqe consideres interesante

Para estudiar la distribución de las variables vamos a hacerlo de manera gráfica. Para ello necesitamos un paquete que nos permita realizar visualizaciones. Con el siguiente código instalamos el paquete necesario.

```{r message=FALSE}
if(!require(ggplot2)) install.packages(ggplot2)
library(ggplot2)

if(!require(patchwork)) install.packages(patchwork)
library(patchwork)
```

Una vez importado el paquete necesario podemos proceder a realizar visualizaciones que nos faciliten la comprensión de los datos, en este caso la distribución de estos. Para ello utilizaremos diagramas de cajas.

Con el siguiente código generamos un diagrama de cajas para cada una de las variables.

```{r}
config.estilosBoxPlot <- list(
  theme(
    axis.text.y  = element_blank(),
    axis.ticks.y = element_blank()
  )
)
```

```{r}
g_disp_GAME_TIME <- datos_ej1 %>% 
  mutate(
    GAME_TIME_S = GAME_TIME/1000
  ) %>%
  ggplot() +
  geom_boxplot(aes(x = GAME_TIME_S)) +
  config.estilosBoxPlot

g_disp_GAME_TIME

```
Podemos ver que la distribución de los datos 

```{r}

 g_disp_COMPLETED_LEVELS <- datos_ej1 %>% 
  ggplot() +
  geom_boxplot(aes(x = COMPLETED_LEVELS)) +
  config.estilosBoxPlot

g_disp_COMPLETED_LEVELS

```
Podemos ver que en este caso la mayoría de los datos se distribuyen entre 0 y 4 niveles. Lo que nos indica que la mayoría de jugadores se estancan en el nivel 4. También nos encontramos con _outliers_, que son valores a tipicos que tendremos que tender en cuenta a la hora de realizar cualquier análisis.

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
aaa